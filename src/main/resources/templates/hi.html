<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<head>
    <meta charset="UTF-8">
    <title>Mainpage</title>
    <link rel="stylesheet" href="/css/hi.css">
    <link rel="icon" type="image/png" href="/Login_v2/images/icons/favicon.ico"/>
<style>
    .bbb {
        text-decoration-line: none;
        font-size: 20px;
    }
</style>
    <link rel="stylesheet" href="/css/main.css">

</head>
<body>
<div class="big_box">
<nav>
    <div class="menu-btn">
        <div class="line line--1"></div>
        <div class="line line--2"></div>
        <div class="line line--3"></div>
    </div>

    <div class="nav-links">
        <a href="/start" class="link">Home</a>
        <a th:href="@{/mailList/{empno}(empno=${working.empno})}" class="link"> Mail </a>
        <a href="/vacationRequest" class="link">Vacation Request</a>
        <a href="/schedule" class="link">Schedule Request </a>

        <th:block th:if="${authority}=='row'">
            <a href="/Vacationdept" class="link">Dept</a>
        </th:block>
        <th:block th:if="${authority}=='admin'">
            <a href="/registerpage" class="link">EmpRegist</a>
        </th:block>

    </div>
</nav>
    <p class="today"></p>
<th:block th:if="${vacation == '휴가' || vacation == '무급'}">

    <p th:text="${working.name+' 님은 오늘 휴가 날입니다'}" ></p>
    <img th:src="@{/images/__${working.getName()}__.png}" alt="내 이미지"> <br> <br>
    <span  th:text="'출근 시각 '+${working.cometime}"></span> <br> <br>
    <span  th:text="'퇴근 시각'+${working.gotime}"></span> <br> <br>
    <span  th:text="'현재 출근 상태:'+${working.isworking}"></span> <br> <br>

    <input value="출근" type="button" onclick="vac()">
    <input value="퇴근" type="button" onclick="vac()">
    <br>

    <table border="0">
        <thead>
        <tr>
            <th colspan="3"> <span th:text="${deptname}"></span> </th>
        </tr>
        </thead>
        <tbody>
        <th:block th:each="dto, iterStat : ${list}">
            <!-- 매 세 번째 요소마다 새로운 행을 시작 -->
            <th:block th:if="${iterStat.index % 3 == 0}">
                </tr><tr>
            </th:block>
            <!-- 각 사원 정보를 셀에 출력 -->
            <td>
                <img th:src="@{/images/__${dto.getName()}__.png}" alt="내 이미지"> <br>
                <span th:text="${dto.getName()}"></span> :
                <span th:text="${dto.getIsworking()}"></span><br>
                <a th:href="@{'/deptSendMail/' + ${dto.empno}}">
                    <img th:src="@{/images/mailicon.png}" alt="메일" width="20" height="20">
                </a><br>
            </td>
        </th:block>
        </tbody>
    </table>

</th:if>
</th:block>

<th:block th:if="${vacation != '휴가' && vacation != '무급'}">
    <div class="fff">
    <table >

        <div style="position: fixed;margin-left: 11.5%;margin-top: 14px;font-size: 25px;">
        <p>근무 스케쥴</p>
        </div>
        <div style="position: fixed;margin-left: 11.5%;margin-top: 55px;font-weight: 00;">
            <p th:text="${result}" ></p>
        </div>



    <div style="margin-top:9%;margin-left: 7%;">
  <a href="/logout" >  <img th:src="@{/images/__${working.getName()}__.png}" alt="내 이미지"  style="border-radius: 30%"> </a><br>
    </div>
        <div style="margin-top:3%;margin-left: 15%;font-size:20px;">
        <span th:text="${working.name}"></span>
        </div>
<br>
        <div style="margin-top:-5%;margin-left: 15%;font-size:20px;">
        <p th:text="${job}"></p>
        </div>

        <div  style="display: flex ; margin-left: 45%; margin-top: -27%;font-size: 50px;">

                <p class="clock"></p>
            </div>

        <div style="position:fixed;margin-left: 4%; margin-top: 1%">
        <input value="출근" type="button" onclick="makecommute()" class="main_button">
        <input value="퇴근" type="button" onclick="quitcommute()" class="main_button">

<input value="연장근무" type="button" onclick="requestextrawork()" class="main_button">


<th:block th:if="${working.isworking} =='외출'">
<input id="takearestbutton1" value="복귀" type="button" onclick="takearest()" class="main_button">
</th:block>

<th:block th:if="${working.isworking != '외출'}">
    <input id="takearestbutton" value="외출" type="button" onclick="takearest()" class="main_button">
</th:block>
    </div>

    <br>
        <div style="position: fixed;margin-left:5%;margin-top: 3.5%">
    <span id="text" th:text="'출근 시각 '+${working.cometime}"></span>&emsp;&emsp;
    <span id="text2" th:text="'퇴근 시각 '+${working.gotime}"></span>
        </div>
<br><br>
        <div style="position: fixed;margin-left: 8%;margin-top: 3.5%">
    <span id="nowtext" th:text="'현재 상태: '+${working.isworking}"></span>
        </div>
            <!--같은 버튼이나 화면 온로드 당시의 근무 상황에 따라 버튼의 밸류 변경 -->

<!--<input value="초기화" type="button" onclick="reset()" class="main_button">-->
<!--        <a th:href="@{/logout}" class="bbb">로그아웃</a>-->
</td>
    </table>

<br>
<br>

    <br>
    <br>
<div class="team">

    <table border="0" style="border-collapse: collapse;">
        <thead>
        <tr>
            <th colspan="2" style="color: black; border-radius: 10%;">
                <span th:text="${deptname}"></span>
            </th>
        </tr>
        </thead>
        <tbody>
        <th:block th:each="dto, iterStat : ${list}">
            <!-- 매 세 번째 요소마다 새로운 행을 시작 -->
            <th:block th:if="${iterStat.index % 2 == 0}">
                </tr><tr>
            </th:block>
            <!-- 각 사원 정보를 셀에 출력 -->
            <td style="border: 0px solid #000; padding: 5px; text-align: center;">
                <img th:src="@{/images/__${dto.getName()}__.png}" alt="내 이미지"><br>
                <span th:text="${dto.getName()}"></span> :
                <span th:text="${dto.getIsworking()}"></span><br>
                <a th:href="@{'/deptSendMail/' + ${dto.empno}}">
                    <img th:src="@{/images/mailicon.png}" alt="메일" width="20" height="20">
                </a><br>
            </td>
        </th:block>
        </tbody>
    </table>
</div>
<!--   오유비 추가 코드 10월05일 부서 근태 현황을 카운트 해서 숫자로 나타냄-->
<br>
        <div class = "highlighted">
            <table class="depttable">
                <tr>
                    <th class = "stu_title"  colspan="4" >근태현황</th>

                <tr class="sss">

                    <td class ="dept_td">
                        출근 전

                    </td>
                    <td class ="dept_td">
                        [[${preWorkCount}]]
                    </td>
                    <td class ="dept_td">
                        출근
                    </td>
                    <td class ="dept_td">
                        [[${workCount}]]
                    </td>

                </tr>
                <tr class="sss">
                    <td class ="dept_td">
                        퇴근
                    </td>
                    <td class ="dept_td">
                        [[${leaveCount}]]
                    </td>
                    <td class ="dept_td">
                        외출
                    </td>
                    <td class ="dept_td">
                        [[${commuteCount}]]
                    </td>
                <tr class="sss">
                    <td class ="dept_td">
                        휴가
                    </td>
                    <td class ="dept_td">
                        [[${vacationCount}]]
                    </td>
                    <td class ="dept_td">
                        총원
                    </td>
                    <td class ="dept_td">
                        [[${countTotal}]]
                    </td>
                </tr>
            </table>
        </div>

</th:block>
    <div class="mail">
        <th:block th:if="${not mail.empty}">
            <h3>&nbsp;&nbsp;최근 온 메일</h3>
            <hr style="width: 300px;">
            <table th:each="mail : ${mail}" th:unless="${mailStat.index > 3}" >
                <tbody>
                    <tr>
                            <td>
                                <a th:href="@{'/mailDetail/' + ${mail.id}}" class="mail_title">
                                    [[${mail.title}]]
                                </a>
                            </td>
                    </tr>
                    <tr>
                        <td>
                            &nbsp;&nbsp;&nbsp;&nbsp;<th:block th:text="${mail.sName}"></th:block>
                        </td>
                        <td class="date_batch">
                            <th:block th:text="${#temporals.format(mail.date, 'yyyy.MM.dd')}"></th:block>
                        </td>
                    </tr>
                </tbody>
            </table>
        </th:block>

        <th:block th:if="${mail.empty}">
            <p><h3>메일이 없습니다.</h3></p>
        </th:block>
    </div>

<div style="left: 42%; top: 40%; position: fixed">
    <th:block th:if="${not list3.empty}">

        <table >
            <thead>

            <tr>
                <a style="text-align: center;font-size:20px ">부서 공지사항</a>
            </tr>

            <tr th:each="notice : ${list3}">
                <td>
                    <th:block th:text="·"></th:block>
                </td>

                <td>  <a th:href="@{'/noticeDetail/' + ${notice.id}}" style="font-size:20px;">
                    [[${notice.title}]]
                </a></td>
            </tr>
            </thead>

        </table>


    </th:block>
</div>


<script src="/js/hi.js"></script>
<script th:inline="javascript">
    var resultValue = /*[[${result}]]*/ '';

    // 이거 윗줄 회색글씨 절대 지우면 안됨
</script>

</div>
</body>
</html>